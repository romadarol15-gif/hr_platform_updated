# Инструкция по настройке HR Platform v2.0

## Исправление проблемы с полями ФИО

Если у вас проблемы с отображением или редактированием полей Фамилия/Имя, следуйте этой инструкции:

### Шаг 1: Скачайте последнюю версию

```bash
# Если используете git:
git pull origin main

# Или скачайте ZIP с GitHub и распакуйте
```

### Шаг 2: Активируйте виртуальное окружение

```bash
.venv\Scripts\activate
```

### Шаг 3: Примените миграции

```bash
# Если есть конфликт миграций:
python manage.py makemigrations --merge
# Нажмите 'y' для подтверждения

# Примените миграции:
python manage.py migrate
```

### Шаг 4: Создайте тестовых пользователей

```bash
python create_test_users.py
```

Этот скрипт создаст:
- **admin** / admin12345 (Администратор)
- **00000009** / admin12345 (Бухгалтер - Егоров Сергей)
- **00000002** / admin12345 (Тестировщик - Иванов Петр)
- **00000008** / admin12345 (Дизайнер - Морозов Николай)

### Шаг 5 (Опционально): Копирование существующих данных

Если у вас уже есть пользователи и нужно копировать их ФИО:

```bash
python copy_user_data.py
```

### Шаг 6: Запустите сервер

```bash
python manage.py runserver
```

Откройте в браузере: http://127.0.0.1:8000/

---

## Решение проблем

### Проблема: "no such column: hr_employee.last_name"

Это означает, что миграции не применены. Выполните:

```bash
python manage.py migrate
```

### Проблема: Конфликт миграций

```bash
python manage.py makemigrations --merge
python manage.py migrate
```

### Проблема: Не могу войти под admin

```bash
# Создайте заново:
python create_test_users.py

# Или создайте вручную:
python manage.py createsuperuser
```

### Проблема: Поля ФИО пустые

```bash
# Скопируйте данные из User в Employee:
python copy_user_data.py
```

---

## Функциональность

### Права доступа

| Роль | Просмотр профилей | Редактирование ФИО | Редактирование Роли/Должности |
|------|-----------------|------------------|--------------------------------|
| Обычный сотрудник | ✅ Всех | ❌ Нет (readonly) | ❌ Нет (readonly) |
| Бухгалтер | ✅ Всех | ✅ Да | ✅ Да |
| Администратор | ✅ Всех | ✅ Да | ✅ Да |

### Readonly поля для обычных сотрудников:

- Фамилия (серый фон)
- Имя (серый фон)
- Отчество (серый фон)
- Роль (серый фон)
- Должность (серый фон)
- Отдел (серый фон)

---

## Технические детали

В версии v2.0 поля `first_name` и `last_name` были добавлены непосредственно в модель `Employee`, чтобы они работали так же, как `middle_name` (Отчество).

Это упрощает работу с формами и позволяет использовать readonly атрибуты для ограничения доступа.
