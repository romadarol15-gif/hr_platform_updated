import os
import django
from datetime import date, timedelta
import random

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'hr_project.settings')
django.setup()

from django.contrib.auth.models import User
from hr.models import Task

print("–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–¥–∞—á...\n")

# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∑–∞–¥–∞—á–∏
Task.objects.all().delete()
print("‚úì –°—Ç–∞—Ä—ã–µ –∑–∞–¥–∞—á–∏ —É–¥–∞–ª–µ–Ω—ã\n")

# –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
admin = User.objects.get(username='admin')
users = list(User.objects.filter(username__startswith='0000').filter(is_active=True)[:8])

if not users:
    print("‚ùå –û—à–∏–±–∫–∞: –ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π-—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤")
    print("–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ install.bat\n")
    exit(1)

# –®–∞–±–ª–æ–Ω—ã –∑–∞–¥–∞—á
tasks_data = [
    # –ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (5 —à—Ç—É–∫)
    {
        'title': '–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏',
        'description': '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:\n- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º\n- –ì—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã\n- –û—Ç—á—ë—Ç—ã –ø–æ –∑–∞–¥–∞—á–∞–º',
        'status': 'new',
        'days_offset': 14  # –°—Ä–æ–∫ —á–µ—Ä–µ–∑ 14 –¥–Ω–µ–π
    },
    {
        'title': '–û–±–Ω–æ–≤–∏—Ç—å –¥–∏–∑–∞–π–Ω –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã',
        'description': '–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å –¥–∏–∑–∞–π–Ω –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–º—É –±—Ä–µ–Ω–¥–±—É–∫—É –∫–æ–º–ø–∞–Ω–∏–∏',
        'status': 'new',
        'days_offset': 7
    },
    {
        'title': '–ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏',
        'description': '–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:\n- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ä–æ–ª–µ–π\n- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞\n- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è',
        'status': 'new',
        'days_offset': 5
    },
    {
        'title': '–ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é',
        'description': '–°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ API —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤',
        'status': 'new',
        'days_offset': 21
    },
    {
        'title': '–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö',
        'description': '–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö',
        'status': 'new',
        'days_offset': 10
    },
    
    # –í —Ä–∞–±–æ—Ç–µ (5 —à—Ç—É–∫)
    {
        'title': '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º–æ–π —É—á—ë—Ç–∞',
        'description': '–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å 1–° –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤',
        'status': 'in_progress',
        'days_offset': 12
    },
    {
        'title': '–î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Excel',
        'description': '–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç Excel',
        'status': 'in_progress',
        'days_offset': 8
    },
    {
        'title': '–ù–∞—Å—Ç—Ä–æ–∏—Ç—å email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è',
        'description': '–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á–∞—Ö –∏ –∑–∞—è–≤–∫–∞—Ö',
        'status': 'in_progress',
        'days_offset': 6
    },
    {
        'title': '–°–æ–∑–¥–∞—Ç—å –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é',
        'description': '–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞',
        'status': 'in_progress',
        'days_offset': 20
    },
    {
        'title': '–ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥–∏ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–ª–∏–∑–∞',
        'description': '–°–ø–∏—Å–æ–∫ –±–∞–≥–æ–≤:\n- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–∫\n- –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è\n- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –∑–∞–¥–∞—á',
        'status': 'in_progress',
        'days_offset': 3
    },
    
    # –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ (5 —à—Ç—É–∫)
    {
        'title': '–ù–∞—Å—Ç—Ä–æ–∏—Ç—å backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö',
        'description': '–ù–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00',
        'status': 'done',
        'days_offset': -5  # –ó–∞–≤–µ—Ä—à–µ–Ω–∞ 5 –¥–Ω–µ–π –Ω–∞–∑–∞–¥
    },
    {
        'title': '–û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞',
        'description': '–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–µ—Ä—Å–∏–π',
        'status': 'done',
        'days_offset': -10
    },
    {
        'title': '–ü—Ä–æ–≤–µ—Å—Ç–∏ security audit',
        'description': '–ü—Ä–æ–≤–µ–¥—ë–Ω –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ',
        'status': 'done',
        'days_offset': -15
    },
    {
        'title': '–î–æ–±–∞–≤–∏—Ç—å –ø–æ–∏—Å–∫ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º',
        'description': '–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–∏—Å–∫ –ø–æ —Ç–∞–±–µ–ª—å–Ω–æ–º—É –Ω–æ–º–µ—Ä—É –∏ –§–ò–û',
        'status': 'done',
        'days_offset': -3
    },
    {
        'title': '–°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Ä–æ–ª–µ–π',
        'description': '–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π: –°–æ—Ç—Ä—É–¥–Ω–∏–∫, –ë—É—Ö–≥–∞–ª—Ç–µ—Ä, –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
        'status': 'done',
        'days_offset': -20
    },
]

print("–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á:\n")

created_count = 0
for i, task_data in enumerate(tasks_data, 1):
    # –°–ª—É—á–∞–π–Ω—ã–π —Å–æ–∑–¥–∞—Ç–µ–ª—å –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
    creator = random.choice([admin] + users[:3])
    assignee = random.choice(users)
    
    # –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    due_date = date.today() + timedelta(days=task_data['days_offset'])
    
    task = Task.objects.create(
        title=task_data['title'],
        description=task_data['description'],
        creator=creator,
        assignee=assignee,
        status=task_data['status'],
        due_date=due_date
    )
    
    status_emoji = {
        'new': 'üÜï',
        'in_progress': '‚è≥',
        'done': '‚úÖ'
    }
    
    print(f"{status_emoji[task.status]} TASK-{task.id}: {task.title}")
    print(f"   –°–æ–∑–¥–∞–ª: {creator.employee_profile.get_full_name() if hasattr(creator, 'employee_profile') else 'Admin'}")
    print(f"   –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: {assignee.employee_profile.get_full_name()}")
    print(f"   –°—Ä–æ–∫: {due_date.strftime('%d.%m.%Y')}")
    print()
    
    created_count += 1

print("=" * 60)
print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ –∑–∞–¥–∞—á: {created_count}")
print("=" * 60)
print()
print("–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º:")
print(f"  üÜï –ù–æ–≤—ã–µ: {Task.objects.filter(status='new').count()}")
print(f"  ‚è≥ –í —Ä–∞–±–æ—Ç–µ: {Task.objects.filter(status='in_progress').count()}")
print(f"  ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω—ã: {Task.objects.filter(status='done').count()}")
print()
print("–ó–∞–¥–∞—á–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã!\n")
